{% extends 'base_admin.html' %}
{% block title %}Resource Gallery{% endblock %}
{% block content %}
<h1>Healing Resources 🌼</h1>

<form method="get">
  <label for="tone">Filter by Emotional Tone:</label>
  <select name="tone" id="tone">
    <option value="">All</option>
    <option value="soft" {% if selected_tone == 'soft' %}selected{% endif %}>🌸 Soft</option>
    <option value="neutral" {% if selected_tone == 'neutral' %}selected{% endif %}>🌿 Neutral</option>
    <option value="alert" {% if selected_tone == 'alert' %}selected{% endif %}>⚠️ Alert</option>
  </select>

  <label for="tag">Filter by Tag:</label>
  <select name="tag" id="tag">
    <option value="">All</option>
    {% for tag in tags %}
      <option value="{{ tag.name }}" {% if selected_tag == tag.name %}selected{% endif %}>{{ tag.name }}</option>
    {% endfor %}
  </select>

  <button type="submit">Apply Filters</button>
</form>

<div class="card-grid">
  {% for resource in resources %}
  <div class="card">
    <h3>{{ resource.title }}</h3>
    <p>{{ resource.description|truncatewords:20 }}</p>
    <p><strong>Tone:</strong> {{ resource.emotional_tone }}</p>
    <p><strong>Tags:</strong>
      {% for tag in resource.tags.all %}
        <span class="tag">{{ tag.name }}</span>
      {% empty %}
        <span>No tags</span>
      {% endfor %}
    </p>
    <a href="{{ resource.file.url }}" target="_blank">Preview</a>
    <div class="card-actions">
      <a href="{% url 'edit_resource' resource.id %}">✏️ Edit</a>
      <a href="{% url 'delete_resource' resource.id %}" onclick="return confirm('Are you sure you want to delete this resource?')">🗑️ Delete</a>
    </div>
  </div>
  {% empty %}
  <p>No resources found for this tone or tag.</p>
  {% endfor %}
</div>
{% endblock %}
